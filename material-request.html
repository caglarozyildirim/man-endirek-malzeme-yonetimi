<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malzeme Talebi - IMMA</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Status badges */
        .status-badge.beklemede {
            background-color: #fff3cd;
            color: #856404;
        }
        .status-badge.onaylandi {
            background-color: #d4edda;
            color: #155724;
        }
        .status-badge.teslim {
            background-color: #cce5ff;
            color: #004085;
        }
        .status-badge.reddedildi {
            background-color: #f8d7da;
            color: #721c24;
        }
        .status-badge.iptal {
            background-color: #e2e3e5;
            color: #383d41;
        }
        /* Alert styles */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .alert-info {
            background-color: #e7f3ff;
            border: 1px solid #b6d4fe;
            color: #084298;
        }
        /* View mode styles */
        .view-mode input:disabled,
        .view-mode select:disabled,
        .view-mode textarea:disabled {
            background-color: #f8f9fa !important;
            cursor: not-allowed;
        }
        /* Priority badges */
        .priority-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .priority-badge.low {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        .priority-badge.normal {
            background-color: #d4edda;
            color: #155724;
        }
        .priority-badge.high {
            background-color: #fff3cd;
            color: #856404;
        }
        .priority-badge.critical {
            background-color: #f8d7da;
            color: #721c24;
        }
        /* Delivery location checkboxes */
        .delivery-locations {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        .delivery-location-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        /* Material Selection Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.active {
            display: flex;
        }
        .modal-content {
            background: #fff;
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            margin: 0;
            font-size: 18px;
            color: #333;
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 0;
            line-height: 1;
        }
        .modal-close:hover {
            color: #333;
        }
        .modal-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }
        .modal-search {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .modal-search input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .modal-search input:focus {
            outline: none;
            border-color: #0066cc;
        }
        .modal-search button {
            padding: 10px 20px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        .modal-search button:hover {
            background: #0055aa;
        }
        .material-list {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        .material-list-header {
            display: grid;
            grid-template-columns: 50px 150px 1fr 100px 100px 100px;
            background: #f5f5f5;
            padding: 12px 15px;
            font-weight: 600;
            font-size: 13px;
            color: #333;
            border-bottom: 1px solid #e0e0e0;
        }
        .material-list-item {
            display: grid;
            grid-template-columns: 50px 150px 1fr 100px 100px 100px;
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 13px;
        }
        .material-list-item:hover {
            background: #f8f9fa;
        }
        .material-list-item.selected {
            background: #e7f3ff;
            border-color: #b6d4fe;
        }
        .material-list-item:last-child {
            border-bottom: none;
        }
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        .modal-footer .btn-cancel {
            padding: 10px 20px;
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        .modal-footer .btn-select {
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        .modal-footer .btn-select:hover {
            background: #218838;
        }
        .modal-footer .btn-select:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .no-results {
            padding: 40px;
            text-align: center;
            color: #666;
        }
    </style>
</head>
<!--
================================================================================
IMMA DEVELOPER DOCUMENTATION
================================================================================

SCREEN: 16 MR - Material Requests
FILE: material-request.html
LAST UPDATED: 2025-12-23

--------------------------------------------------------------------------------
RELATED DATABASE TABLES
--------------------------------------------------------------------------------

TABLE: Material Request Header (Data Structure IMMA.xlsx)
| Field Name                    | Type     | Length | Description                           |
|-------------------------------|----------|--------|---------------------------------------|
| Material request header Id    | int      | 12     | Primary key - Otomatik olu≈üturulur    |
| SL user info                  | int      | 8      | Shift Leader kullanƒ±cƒ± ID             |
| Created by user info          | int      | 8      | Talebi olu≈üturan kullanƒ±cƒ± ID         |
| Created for user info         | int      | 8      | Talep kimin i√ßin olu≈üturuldu          |
| Creation date time            | datetime | -      | Olu≈üturma tarihi/saati                |
| Selected week number          | int      | 2      | Se√ßilen hafta numarasƒ± (1-52)         |
| Selected weeks first day      | date     | -      | Haftanƒ±n ilk g√ºn√º (Pazartesi)         |
| Description for the request   | text     | 256    | Talep a√ßƒ±klamasƒ± ZORUNLU              |
| Requesting department         | text     | 8      | Talep eden departman kodu             |
| Requesting user info          | int      | 8      | Talep eden kullanƒ±cƒ± ID               |
| Cost Center Code              | text     | 10     | Masraf merkezi kodu                   |
| Total Euro Value of request   | float    | 15     | READONLY - Otomatik hesaplanƒ±r        |
| Delivery Location 1 id        | text     | 8      | Teslimat lokasyonu 1                  |
| Delivery Location 2 id        | text     | 8      | Teslimat lokasyonu 2                  |
| Delivery Location 3 id        | text     | 8      | Teslimat lokasyonu 3                  |
| Delivery Location 4 id        | text     | 8      | Teslimat lokasyonu 4                  |
| Delivery Location 5 id        | text     | 8      | Teslimat lokasyonu 5                  |
| Other Location text           | text     | 64     | Alternatif teslimat lokasyonu         |
| Over budget value             | float    | 14     | B√ºt√ße a≈üƒ±m miktarƒ± (EUR)              |
| Request total value           | float    | 14     | Talep toplam deƒüeri (EUR)             |
| SL approval check             | bool     | -      | SL onayƒ± verildi mi?                  |
| SL approval no required check | bool     | -      | SL onayƒ± gerekmez flag                |

NOT: A≈üaƒüƒ±daki alanlar Data Structure IMMA.xlsx Material Request Header tablosunda BULUNMUYOR.
Ekran fonksiyonelliƒüi i√ßin eklenen alanlar:
| Field Name                    | Type     | Description                           |
|-------------------------------|----------|---------------------------------------|
| SL approver user info         | int      | SL onayƒ± veren kullanƒ±cƒ± ID           |
| SL approval date time         | datetime | SL onay tarihi/saati                  |
| SL approved by user info      | int      | Onaylayan SL kullanƒ±cƒ± ID             |
| over budget check             | bool     | B√ºt√ße a≈üƒ±mƒ± var mƒ±?                   |
| Budget Id                     | int      | ƒ∞li≈ükili b√ºt√ße kaydƒ± ID               |
| Approval finish date time     | datetime | Onay tamamlanma tarihi                |

TABLE: Material Request Item (Data Structure IMMA.xlsx)
| Field Name                    | Type     | Length | Description                           |
|-------------------------------|----------|--------|---------------------------------------|
| Material Request item id      | int      | 12     | Primary key                           |
| Material request header Id    | int      | 8      | Header referansƒ± (FK)                 |
| Material request item no      | int      | 4      | Satƒ±r numarasƒ±                        |
| Material number               | text     | 13     | Malzeme numarasƒ± (FK)                 |
| Requested Quantity            | float    | 15     | Talep edilen miktar                   |
| Priority                      | bool     | -      | √ñncelikli mi? (checkbox)              |
| Delivered quantity            | float    | 15     | Teslim edilen miktar                  |
| Material delivery finalized   | bool     | -      | Teslimat tamamlandƒ± mƒ±?               |
| Item total Euro value         | float    | 14     | Satƒ±r toplam deƒüeri (EUR)             |
| Selected to transfer          | bool     | -      | Transfer i√ßin se√ßildi mi?             |
| Rollback initiated check      | bool     | -      | Geri alma ba≈ülatƒ±ldƒ± mƒ±?              |

--------------------------------------------------------------------------------
SCREEN FIELDS (UI Elements) - Screen Designs: 16 MR
--------------------------------------------------------------------------------

HEADER SECTION:
- Material request number (readonly) - Talep numarasƒ± (otomatik)
- SL user info (dropdown) - Shift Leader se√ßimi
- Created by user info (readonly) - Olu≈üturan kullanƒ±cƒ±
- Created for user info (dropdown) - Kimin i√ßin olu≈üturuluyor
- Creation date time (readonly) - Olu≈üturma tarihi
- Selected week number (dropdown) - Hafta se√ßimi, ZORUNLU
- Selected weeks first day (readonly) - Haftanƒ±n ilk g√ºn√º (hesaplanan)
- Description for the request (textarea) - Talep a√ßƒ±klamasƒ±
- Requesting department (dropdown) - Talep eden departman
- Cost Center Code (dropdown) - Maliyet merkezi
- Cost Center Title (readonly) - Maliyet merkezi adƒ±
- Total Euro Value of request (readonly) - Toplam EUR deƒüeri (hesaplanan)

DELIVERY LOCATIONS:
- Delivery Location 1 (dropdown) - Teslimat lokasyonu 1
- Delivery Location 2 (dropdown) - Teslimat lokasyonu 2
- Delivery Location 3 (dropdown) - Teslimat lokasyonu 3
- Delivery Location 4 (dropdown) - Teslimat lokasyonu 4
- Delivery Location 5 (dropdown) - Teslimat lokasyonu 5
- Other Location text (text) - Diƒüer lokasyon a√ßƒ±klamasƒ±

REQUEST ITEMS TABLE:
| Column                    | Description                          |
|---------------------------|--------------------------------------|
| Material number           | Malzeme numarasƒ± (arama)             |
| Material title            | Malzeme ba≈ülƒ±ƒüƒ± (readonly)           |
| Unit of Measure           | √ñl√ß√º birimi                          |
| Requested Quantity        | Talep edilen miktar                  |
| Priority                  | √ñncelikli mi? (checkbox)             |
| Weekly quantity limit     | Haftalƒ±k limit (readonly)            |
| Total Stock               | Toplam stok (readonly)               |
| Open Requests quantity    | A√ßƒ±k talep miktarƒ± (readonly)        |
| Available quantity        | Kullanƒ±labilir miktar (readonly)     |

STOCK ASSIGNMENT (Satƒ±r bazƒ±nda):
- Stock record Id - Stok kaydƒ± ID
- Assigned storage - Atanan depo
- Assigned location - Atanan lokasyon
- Assigned storage bin - Atanan bin

BUDGET INFORMATION PANEL:
- Related Budgets table:
  | Budget Level | Consumed | Available |
  |--------------|----------|-----------|
  | Year         | XXXXX    | XXXXX     |
  | Month        | XXXXX    | XXXXX     |
  | SL           | XXXXX    | XXXXX     |
  | SL Weekly    | XXXXX    | XXXXX     |
- Over budget value (readonly) - B√ºt√ße a≈üƒ±m tutarƒ±
- Request total value (readonly) - Talep toplam tutarƒ±

APPROVAL SECTION:
- SL approval check - SL onay checkbox
- SL approval no required check - SL onay gereksiz
- SL approver user info (readonly) - Onaylayan SL
- SL approval date time (readonly) - Onay tarihi

ACTION BUTTONS:
- Add Item - Yeni malzeme ekle
- Remove Item - Malzeme sil
- Save Draft - Taslak kaydet
- Submit for Approval - Onaya g√∂nder
- Cancel - ƒ∞ptal

--------------------------------------------------------------------------------
BUSINESS RULES (ƒ∞≈ü Kurallarƒ±)
--------------------------------------------------------------------------------

1. Malzemenin maliyeti talep eden tarafƒ±ndan g√∂r√ºlebilmelidir.
2. Mevcut stok otomatik olarak atanacak ve manuel olarak yeniden atanamaz.
3. Depo, lokasyon ve bin √º√ß farklƒ± depolama tipidir.
4. Bloklu malzemeler kullanƒ±cƒ±lar tarafƒ±ndan g√∂r√ºlebilir ancak se√ßilemez. Bloklama nedeni ve Bloklama yeniden deƒüerlendirme tarihi de g√∂r√ºlebilir.
5. Bir malzeme i√ßin birden fazla maliyet olabilir, se√ßim sƒ±rasƒ±nda g√∂r√ºlmelidir. Stok FIFO kurallarƒ±na g√∂re se√ßilecektir.
6. Malzeme, kullanƒ±cƒ± talep formuna eklediƒüi anda √ßƒ±kƒ±≈ü yapƒ±lana kadar rezerve edilmelidir.
7. Kullanƒ±cƒ± mevcut stoktan fazlasƒ±nƒ± talep edemez.
8. Stok yoksa kullanƒ±cƒ± malzemeyi g√∂r√ºnt√ºleyebilir ancak talep edemez.
9. Kullanƒ±cƒ± malzeme kodunu √º√ß karakter girdikten sonra otomatik √∂neri √ßalƒ±≈ümalƒ±dƒ±r.
10. Kullanƒ±cƒ± malzeme a√ßƒ±klamasƒ±nƒ± 3 karakter girdikten sonra her ek karakterde √∂neriler g√∂r√ºnmelidir.
11. Olu≈üturmadan 3. ve 6. g√ºn sonra onaylayƒ±cƒ±ya hatƒ±rlatma e-postasƒ± g√∂nderilmelidir. 7. g√ºn onaylayƒ±cƒ±ya ve onaylayƒ±cƒ±nƒ±n ilk y√∂neticisine hatƒ±rlatma e-postasƒ± g√∂nderilmelidir.
12. Y√∂neticiler ve SL'ler BT sistemlerinden otomatik alƒ±nacak ve yetkiler pozisyonlarƒ±na g√∂re otomatik tanƒ±mlanacaktƒ±r.
13. BT sistem baƒülantƒ±larƒ± saƒülanana kadar kullanƒ±cƒ± verileri Excel y√ºklemeleriyle y√∂netilecektir.
14. Bir ki≈üi i√ßin haftalƒ±k malzeme limiti belirlenebilir. Deƒüer sƒ±fƒ±r ise bu malzeme ki≈üi tarafƒ±ndan talep edilemez.
15. Malzemenin talep edildiƒüi hafta numarasƒ± zorunludur. Sadece mevcut hafta ve bir sonraki hafta i√ßin talep olu≈üturulabilir. Ayrƒ±ca haftanƒ±n ilk g√ºn√º teslimat tarihi olarak g√∂r√ºlmeli ve hafta i√ßinde daha ileri bir tarih se√ßilebilmelidir.
16. Kullanƒ±cƒ±nƒ±n talep ettiƒüi malzeme miktarƒ± bir stok kaydƒ±yla rezerve edilemezse, a≈üan miktar ba≈üka stok kaydƒ±na atanacak ve her stok kaydƒ± i√ßin malzeme talep kalemleri olu≈üturulacaktƒ±r.
17. Kullanƒ±cƒ± malzemeyi malzeme talebine girdiƒüinde stok m√ºsaitlik bilgisi g√∂r√ºnecektir.
18. Teslimat lokasyonu se√ßilmelidir. 4 seviyeli olacak ve i≈ü istasyonlarƒ± da se√ßilebilecektir. Serbest metin giri≈üi i√ßin de se√ßenek olmalƒ±dƒ±r.
19. Son onay tamamlandƒ±ƒüƒ±nda "Onay biti≈ü tarih saati" alanƒ± mevcut tarih saat ile doldurulacaktƒ±r.
20. Maliyet Merkezleri Departmanlara atanƒ±r. Bir departmana birden fazla maliyet merkezi atanabilir.
21. Talep eden kullanƒ±cƒ± bilgi alanlarƒ± varsayƒ±lan olarak olu≈üturulan bilet ile doldurulacaktƒ±r. Kendi personeli altƒ±ndaki bir kullanƒ±cƒ±ya deƒüi≈ütirilebilir.
22. Departman y√∂neticileri malzeme talebi onayƒ± i√ßin kendileri adƒ±na alternatif onaylayƒ±cƒ± atayabilir.
23. T√ºm b√ºt√ße ve maliyetler i√ßin para birimi Euro'dur.
24. FIFO kuralƒ± kesindir, √∂nce √ßƒ±kƒ±≈ü yapƒ±lan malzeme daha sonraki fiyatlarla rezerve edilmi≈ü olsa bile en erken malzeme fiyatƒ±na sahip olacaktƒ±r.
25. Rezerve edilen malzemeler ve fiyat, maliyet atamasƒ±ndaki olasƒ± deƒüi≈üiklikler nedeniyle malzeme talebinde yeni satƒ±rlarla g√∂r√ºnt√ºlenecektir.
26. SRM Talebi i√ßin beklenen teslimat tarihi, kalemlerdeki en eski beklenen teslimat tarihidir.
27. Malzeme a√ßƒ±klamasƒ± malzeme talep edildiƒüinde g√∂r√ºlebilir ancak malzeme notlarƒ± sadece endirekt malzeme anahtar kullanƒ±cƒ±sƒ± tarafƒ±ndan g√∂r√ºlmelidir.
28. Maliyet merkezi zorunludur, bir departmanƒ±n maliyet merkezi atamasƒ± yoksa kullanƒ±cƒ± malzeme talebi yapamaz.

29. KOPYALA-YAPI≈ûTIR KURALI (Excel Screen Designs):
    - Kullanƒ±cƒ± Excel'den kopyalanan verileri yapƒ±≈ütƒ±rabilir
    - Birden fazla h√ºcre se√ßip aynƒ± anda satƒ±r ekleyebilir
    - Toplu veri giri≈üi desteklenir
    - Yapƒ±≈ütƒ±rƒ±lan veriler format kontrol√ºnden ge√ßirilir

30. ALTERNATƒ∞F MALZEME SE√áƒ∞M KURALI (Excel Screen Designs):
    - Kullanƒ±cƒ± alternatif malzeme listesinden se√ßim yapabilir
    - Alternatif malzeme se√ßilirse ana malzeme YERƒ∞NE eklenir
    - Alternatif malzemenin stoƒüu YOKSA se√ßilemez (disabled g√∂sterilir)
    - Alternatif malzeme BLOKE stat√ºs√ºndeyse se√ßilemez
    - Bloke malzemeler i√ßin bloklama nedeni ve yeniden deƒüerlendirme tarihi g√∂r√ºnt√ºlenir

B√úT√áE KONTROL√ú:
1. Talep kaydedilmeden √∂nce haftalƒ±k SL b√ºt√ßesi kontrol edilir
2. B√ºt√ße a≈üƒ±mƒ± varsa over_budget_check = true
3. Budget Preference'a g√∂re onay s√ºreci ba≈ülatƒ±lƒ±r:
   - Type 1: SL onayƒ± gerekli
   - Type 2: Sadece b√ºt√ße a≈üƒ±mƒ±nda SL onayƒ±
   - Type 3: Manager onayƒ± gerekli
   - Type 4: Sadece b√ºt√ße a≈üƒ±mƒ±nda manager onayƒ±
   - Type 5: Sadece TL ve √ºst√º talep yapabilir
   - Type 6: B√ºt√ße onayƒ± gerekmez

--------------------------------------------------------------------------------
FIELD VALIDATIONS
--------------------------------------------------------------------------------

- Material request header Id: maxlength=12, READONLY, otomatik olu≈üturulur
- Selected week number: 1-52 arasƒ±, ZORUNLU
- Description for the request: maxlength=256, min 10 karakter, ZORUNLU
- Requesting department: maxlength=8, ZORUNLU
- Cost Center Code: maxlength=10, ZORUNLU
- Other Location text: maxlength=64
- Requested Quantity: > 0, stoktan fazla olamaz
- Material number: ##.#####-#### formatƒ±, ZORUNLU

Hesaplanan alanlar (READONLY):
- Total Euro Value of request: Sum(Item total Euro value)
- Over budget value: Request total - Available budget (if positive)
- Selected weeks first day: Week number'dan hesaplanƒ±r

--------------------------------------------------------------------------------
WORKFLOW / PROCESS FLOW
--------------------------------------------------------------------------------

CREATE MODE:
1. Kullanƒ±cƒ± "Yeni Malzeme Talebi" ekranƒ±nƒ± a√ßar
2. Hafta numarasƒ± se√ßer (varsayƒ±lan: mevcut hafta)
3. Departman ve Cost Center se√ßer
4. Talep a√ßƒ±klamasƒ± yazar (min 10 karakter)
5. Teslimat lokasyonu se√ßer (en az 1)
6. "+ Malzeme Ekle" ile malzeme se√ßim modalƒ± a√ßƒ±lƒ±r
7. Malzeme aranƒ±r (3 karakter sonra autosuggest)
8. Miktar girilir (stok kontrol√º yapƒ±lƒ±r)
9. Priority checkbox ile √∂ncelik belirlenir
10. Kaydet ‚Üí Budget kontrol√º yapƒ±lƒ±r
11. Budget OK ‚Üí Talep kaydedilir, SL onayƒ±na gider
12. Budget A≈ûIM ‚Üí Over budget warning, onay gerekebilir

VIEW MODE:
1. T√ºm alanlar READONLY
2. Status badge g√∂sterilir (Beklemede, Onaylandƒ±, Teslim, Reddedildi, ƒ∞ptal)
3. Onay ge√ßmi≈üi g√∂r√ºnt√ºlenebilir
4. Teslimat detaylarƒ± g√∂r√ºn√ºr

EDIT MODE:
1. Sadece "Beklemede" status√ºndeki talepler d√ºzenlenebilir
2. Onaylanmƒ±≈ü/Teslim edilmi≈ü/Reddedilmi≈ü/ƒ∞ptal talepler READONLY
3. D√ºzenleme sonrasƒ± yeniden budget kontrol√º yapƒ±lƒ±r

APPROVAL FLOW:
1. Talep olu≈üturulur ‚Üí Status: Beklemede
2. SL onayƒ± (Budget Preference'a g√∂re) ‚Üí Status: SL Onaylandƒ±
3. Manager onayƒ± (gerekirse) ‚Üí Status: Onaylandƒ±
4. Transfer listesine eklenir
5. Kƒ±smi/Tam teslimat ‚Üí Status: Teslim Edildi

--------------------------------------------------------------------------------
INTEGRATION NOTES
--------------------------------------------------------------------------------

Budget Integration:
- Haftalƒ±k SL b√ºt√ßesinden d√º≈ü√ºm yapƒ±lƒ±r
- Budget Id ile b√ºt√ße kaydƒ±na referans verilir
- Over budget value hesaplanƒ±r ve g√∂sterilir
- Consumed value b√ºt√ße tablosunda g√ºncellenir

Transfer Integration:
- Onaylanan talepler transfer listesine eklenir
- Selected to transfer flag ile transfer i√ßin se√ßim yapƒ±lƒ±r
- Approval finish date time transfer sƒ±ralamasƒ±nda kullanƒ±lƒ±r

Stock Integration:
- FIFO ile cost kayƒ±tlarƒ± otomatik atanƒ±r
- Birden fazla cost kaydƒ±ndan kar≈üƒ±lama yapƒ±labilir
- Delivered quantity teslimat sonrasƒ± g√ºncellenir
- Material delivery finalized teslimat tamamlandƒ±ƒüƒ±nda true

Notification Integration:
- Talep olu≈üturulunca SL'ye bildirim gider
- B√ºt√ße a≈üƒ±mƒ±nda manager'a bildirim gider
- Onay/Red durumunda talep sahibine bildirim gider

================================================================================
-->
<body>
    <!-- NAVBAR - Top Navigation (Maximo Style) -->
    <nav class="modern-navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">
                <div class="navbar-logo">M</div>
                <div class="brand-text">
                    <span class="brand-name">IMMA</span>
                    <span class="brand-subtitle">Endirek Malzeme Y√∂netimi</span>
                </div>
            </a>
            <ul class="navbar-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <span class="nav-icon">üìä</span>
                        Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="material-list.html" class="nav-link">
                        <span class="nav-icon">üì¶</span>
                        Ana Veriler
                    </a>
                    <div class="dropdown-menu">
                        <a href="material-list.html" class="dropdown-item">Malzeme Listesi</a>
                        <a href="supplier-list.html" class="dropdown-item">Tedarik√ßi Listesi</a>
                        <a href="storage-type-list.html" class="dropdown-item">Depo Tipi Listesi</a>
                        <a href="number-series.html" class="dropdown-item">Numara Serileri</a>
                        <a href="material-group.html" class="dropdown-item">Malzeme Gruplarƒ±</a>
                        <a href="unit-of-measure-list.html" class="dropdown-item">√ñl√ß√º Birimleri</a>
                        <a href="department-cost-center-list.html" class="dropdown-item">Departman-Masraf Merkezi</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="mrp.html" class="nav-link">
                        <span class="nav-icon">üìà</span>
                        MRP
                    </a>
                </li>
                <li class="nav-item">
                    <a href="srm-list.html" class="nav-link">
                        <span class="nav-icon">üõí</span>
                        Satƒ±nalma
                    </a>
                    <div class="dropdown-menu">
                        <a href="srm-list.html" class="dropdown-item">Talep Listesi</a>
                        <a href="goods-receipt.html" class="dropdown-item">Mal Kabul</a>
                        <a href="po-list.html" class="dropdown-item">Satƒ±nalma Sipari≈üleri</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="budget-management.html" class="nav-link">
                        <span class="nav-icon">üí∞</span>
                        Budget
                    </a>
                    <div class="dropdown-menu">
                        <a href="budget-management.html" class="dropdown-item">B√ºt√ße Y√∂netimi</a>
                        <a href="budget-preference.html" class="dropdown-item">B√ºt√ße Tercihleri</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="material-request-list.html" class="nav-link active">
                        <span class="nav-icon">üìã</span>
                        Talepler
                    </a>
                    <div class="dropdown-menu">
                        <a href="material-request-list.html" class="dropdown-item active">Talep Listesi</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="transfer-list.html" class="nav-link">
                        <span class="nav-icon">üè≠</span>
                        Stock
                    </a>
                    <div class="dropdown-menu">
                        <a href="direct-issue.html" class="dropdown-item">Doƒürudan √áƒ±kƒ±≈ü</a>
                        <a href="warehouse-transfer.html" class="dropdown-item">Depo Transferi</a>
                        <a href="transfer-list.html" class="dropdown-item">Transfer Listesi</a>
                        <a href="inventory-counting.html" class="dropdown-item">Sayƒ±m ƒ∞≈ülemleri</a>
                        <a href="single-material-counting.html" class="dropdown-item">Tekli Malzeme Sayƒ±mƒ±</a>
                        <a href="scrapping.html" class="dropdown-item">Hurda ƒ∞≈ülemleri</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="user-material-limit-list.html" class="nav-link">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        Ayarlar
                    </a>
                    <div class="dropdown-menu">
                        <a href="user-material-limit-list.html" class="dropdown-item">Kullanƒ±cƒ± Malzeme Limitleri</a>
                        <a href="accounting-confirmation.html" class="dropdown-item">Muhasebe Onaylarƒ±</a>
                    </div>
                </li>
            </ul>
            <div class="navbar-user">
                <span class="user-name">Ahmet Yƒ±lmaz</span>
                <div class="user-avatar">AY</div>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="modern-container">
        <div class="page-header">
            <div>
                <h1 class="page-title" id="pageTitle">Yeni Malzeme Talebi</h1>
                <p class="page-subtitle" id="pageSubtitle">Talepler > Yeni Malzeme Talebi</p>
            </div>
            <div class="page-actions">
                <span id="statusBadge" style="display: none;"></span>
            </div>
        </div>

        <!-- View Mode Notice -->
        <div class="alert alert-info" id="viewModeNotice" style="display: none;">
            <strong>G√∂r√ºnt√ºleme Modu:</strong> Bu talep salt okunur modda g√∂r√ºnt√ºlenmektedir.
            <span id="viewModeReason"></span>
        </div>

        <!-- Developer Notes - Main -->

        <!-- Request Form Section -->
        <div id="requestFormSection">
            <!-- Request Header -->
            <div class="card">
                <div class="card-header">
                    <h3>Request Header</h3>
                </div>
                <div class="card-body">
                    <div class="form-row">
                        <div class="form-group col-3">
                            <label>Material Request header Id</label>
                            <input type="text" class="form-control" id="requestNumber" maxlength="12" value="Material Request-2025-001234" readonly>
                            <small class="form-hint">Otomatik olu≈üturulur</small>
                        </div>
                        <div class="form-group col-3">
                            <label>Creation date time</label>
                            <input type="datetime-local" class="form-control" id="creationDateTime" value="2025-12-15T09:30" readonly>
                        </div>
                        <div class="form-group col-3">
                            <label>Selected week number <span class="required">*</span></label>
                            <select class="form-control" id="weekNumber">
                                <option value="">Se√ßiniz...</option>
                                <option value="50">50. Hafta (9-15 Aralƒ±k)</option>
                                <option value="51" selected>51. Hafta (16-22 Aralƒ±k)</option>
                                <option value="52">52. Hafta (23-29 Aralƒ±k)</option>
                                <option value="1">1. Hafta 2026 (30 Dec - 5 Jan)</option>
                            </select>
                        </div>
                        <div class="form-group col-3">
                            <label>Selected weeks first day</label>
                            <input type="date" class="form-control" id="weekFirstDay" value="2025-12-16" readonly>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-4">
                            <label>SL User info (SL)</label>
                            <input type="text" class="form-control" id="slUser" value="Mehmet Yƒ±lmaz - Bakƒ±m B√∂l√ºm√º" readonly>
                        </div>
                        <div class="form-group col-4">
                            <label>Created by user info</label>
                            <input type="text" class="form-control" id="createdBy" value="Ali Yƒ±ldƒ±z - Bakƒ±m Teknisyeni" readonly>
                        </div>
                        <div class="form-group col-4">
                            <label>Created for user info</label>
                            <input type="text" class="form-control" id="createdFor" value="Ali Yƒ±ldƒ±z" readonly>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-4">
                            <label>Requesting department <span class="required">*</span></label>
                            <select class="form-control" id="requestingDepartment">
                                <option value="">Se√ßiniz...</option>
                                <option value="BAKIM" selected>Bakƒ±m - Mekanik</option>
                                <option value="URETIM">√úretim</option>
                                <option value="KALITE">Kalite</option>
                                <option value="LOJISTIK">Lojistik</option>
                            </select>
                        </div>
                        <div class="form-group col-4">
                            <label>Cost Center Code <span class="required">*</span></label>
                            <select class="form-control" id="costCenterCode">
                                <option value="">Se√ßiniz...</option>
                                <option value="CC-001">CC-001</option>
                                <option value="CC-002" selected>CC-002</option>
                                <option value="CC-003">CC-003</option>
                            </select>
                        </div>
                        <div class="form-group col-4">
                            <label>Cost Center Title</label>
                            <input type="text" class="form-control" id="costCenterTitle" value="Bakƒ±m B√∂l√ºm√º" readonly>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Description for the request <span class="required">*</span></label>
                        <textarea class="form-control" id="requestDescription" rows="2" maxlength="256" placeholder="Talep sebebini ve detaylarƒ±nƒ± a√ßƒ±klayƒ±n...">Boyahane hattƒ±ndaki konvey√∂r sistemi i√ßin planlƒ± bakƒ±m. Motor rulmanlarƒ± deƒüi≈üimi ve yaƒü filtresi yenilenmesi gerekiyor.</textarea>
                    </div>

                    <div class="form-group">
                        <label>Total Euro Value of request</label>
                        <input type="text" class="form-control" id="totalEuroValue" value="1.250,00 EUR" readonly>
                        <small class="form-hint">Otomatik hesaplanƒ±r</small>
                    </div>
                </div>
            </div>

            <!-- Budget Control Section - Over Budget Flags -->
            <div class="card">
                <div class="card-header">
                    <h3>Budget Control</h3>
                </div>
                <div class="card-body">
                    <div class="form-row">
                        <div class="form-group col-4">
                            <label>Over budget value</label>
                            <input type="text" class="form-control" id="overBudgetValue" value="0,00" readonly>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delivery Locations -->
            <div class="card">
                <div class="card-header">
                    <h3>Teslimat Locationlarƒ±</h3>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label>Delivery Locations <span class="required">*</span></label>
                        <div class="delivery-locations">
                            <div class="delivery-location-item">
                                <input type="checkbox" id="loc1" name="deliveryLocation" value="1">
                                <label for="loc1">Location 1 - Ana Storage</label>
                            </div>
                            <div class="delivery-location-item">
                                <input type="checkbox" id="loc2" name="deliveryLocation" value="2" checked>
                                <label for="loc2">Location 2 - Boyahane</label>
                            </div>
                            <div class="delivery-location-item">
                                <input type="checkbox" id="loc3" name="deliveryLocation" value="3">
                                <label for="loc3">Location 3 - Montaj Hattƒ±</label>
                            </div>
                            <div class="delivery-location-item">
                                <input type="checkbox" id="loc4" name="deliveryLocation" value="4">
                                <label for="loc4">Location 4 - Kalite Lab</label>
                            </div>
                            <div class="delivery-location-item">
                                <input type="checkbox" id="loc5" name="deliveryLocation" value="5">
                                <label for="loc5">Location 5 - Sevkiyat</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Other Location text</label>
                        <input type="text" class="form-control" id="otherLocation" maxlength="64" placeholder="Farklƒ± bir teslimat noktasƒ± belirtiniz...">
                        <small class="form-hint">Yukarƒ±daki lokasyonlardan hi√ßbiri uygun deƒüilse buraya yazƒ±nƒ±z</small>
                    </div>
                </div>
            </div>

            <!-- Request Items -->
            <div class="card">
                <div class="card-header">
                    <h3>Requested Materials</h3>
                    <div class="card-header-actions">
                        <button class="btn btn-primary btn-sm" id="addMaterialBtn">+ Malzeme Ekle</button>
                    </div>
                </div>
                <div class="card-body">
                    <table class="table" id="materialsTable">
                        <thead>
                            <tr>
                                <th style="width: 50px;">#</th>
                                <th>Material number <span class="required">*</span></th>
                                <th>Material description</th>
                                <th>Requested Quantity <span class="required">*</span></th>
                                <th>Unit of measure</th>
                                <th>Priority</th>
                                <th style="width: 80px;">ƒ∞≈ülem</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>
                                    <div class="input-group">
                                        <input type="text" class="form-control form-control-sm" value="01.00002-0001" readonly>
                                        <button class="btn btn-sm btn-outline" title="Deƒüi≈ütir">üîÑ</button>
                                    </div>
                                </td>
                                <td>Rulman 6205-2RS</td>
                                <td><input type="number" class="form-control form-control-sm" value="5" min="1" style="width: 90px;"></td>
                                <td>AD</td>
                                <td><input type="checkbox" class="priority-checkbox"></td>
                                <td><button class="btn btn-sm btn-danger">Sil</button></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>
                                    <div class="input-group">
                                        <input type="text" class="form-control form-control-sm" value="01.00001-0001" readonly>
                                        <button class="btn btn-sm btn-outline" title="Deƒüi≈ütir">üîÑ</button>
                                    </div>
                                </td>
                                <td>Elektrik Motoru 5.5kW</td>
                                <td><input type="number" class="form-control form-control-sm" value="2" min="1" style="width: 90px;"></td>
                                <td>AD</td>
                                <td><input type="checkbox" class="priority-checkbox" checked></td>
                                <td><button class="btn btn-sm btn-danger">Sil</button></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>
                                    <div class="input-group">
                                        <input type="text" class="form-control form-control-sm" value="01.00003-0001" readonly>
                                        <button class="btn btn-sm btn-outline" title="Deƒüi≈ütir">üîÑ</button>
                                    </div>
                                </td>
                                <td>Hidrolik Yaƒü ISO 46</td>
                                <td><input type="number" class="form-control form-control-sm" value="20" min="1" style="width: 90px;"></td>
                                <td>LT</td>
                                <td><input type="checkbox" class="priority-checkbox"></td>
                                <td><button class="btn btn-sm btn-danger">Sil</button></td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions" style="margin-top: 20px;" id="actionButtons">
            <button class="btn btn-primary btn-lg" id="saveBtn">Kaydet</button>
            <button class="btn btn-outline" id="cancelBtn">ƒ∞ptal</button>
        </div>

        <!-- View Mode Action Buttons (hidden by default) -->
        <div class="form-actions" style="margin-top: 20px; display: none;" id="viewActionButtons">
            <button class="btn btn-outline" onclick="window.location.href='material-request-list.html'">ƒ∞ptal</button>
        </div>

        <!-- Developer Notes -->

    </main>

    <!-- Material Selection Modal -->
    <div class="modal-overlay" id="materialModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Material Selection</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-search">
                    <input type="text" id="materialSearch" placeholder="Malzeme numarasƒ± veya a√ßƒ±klamasƒ± ile arayƒ±n...">
                    <button id="searchBtn">Ara</button>
                </div>
                <div class="material-list">
                    <div class="material-list-header">
                        <span></span>
                        <span>Material No</span>
                        <span>Material Description</span>
                        <span>Unit</span>
                        <span>Stock</span>
                        <span>Group</span>
                    </div>
                    <div id="materialListBody">
                        <!-- Materials will be populated here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" id="modalCancelBtn">ƒ∞ptal</button>
                <button class="btn-select" id="modalSelectBtn" disabled>Se√ß ve Ekle</button>
            </div>
        </div>
    </div>

    <script>
        // ======================================
        // URL Mode Detection and Handling
        // ======================================
        const urlParams = new URLSearchParams(window.location.search);
        const requestId = urlParams.get('id');
        const mode = urlParams.get('mode') || 'create'; // 'create', 'view', or 'edit'

        // Simulated request data (in real app, this would come from API)
        const requestData = {
            'Material Request-2025-001234': {
                status: 'beklemede',
                statusText: 'Onay Bekliyor',
                editable: true,
                requestNumber: 'Material Request-2025-001234'
            },
            'Material Request-2025-001233': {
                status: 'onaylandi',
                statusText: 'Onaylandƒ±',
                editable: false,
                requestNumber: 'Material Request-2025-001233'
            },
            'Material Request-2025-001232': {
                status: 'teslim',
                statusText: 'Teslim Edildi',
                editable: false,
                requestNumber: 'Material Request-2025-001232'
            },
            'Material Request-2025-001231': {
                status: 'reddedildi',
                statusText: 'Reddedildi',
                editable: false,
                requestNumber: 'Material Request-2025-001231'
            },
            'Material Request-2025-001230': {
                status: 'iptal',
                statusText: 'ƒ∞ptal Edildi',
                editable: false,
                requestNumber: 'Material Request-2025-001230'
            }
        };

        function updatePageTitle(mode, requestNo) {
            const titleElement = document.getElementById('pageTitle');
            const subtitleElement = document.getElementById('pageSubtitle');

            if (mode === 'create') {
                titleElement.textContent = 'Yeni Malzeme Talebi';
                subtitleElement.textContent = 'Talepler > Yeni Malzeme Talebi';
            } else if (mode === 'edit') {
                titleElement.textContent = 'Malzeme Talebi D√ºzenle: ' + requestNo;
                subtitleElement.textContent = 'Talepler > Talep D√ºzenle';
            } else if (mode === 'view') {
                titleElement.textContent = 'Malzeme Talebi Detay: ' + requestNo;
                subtitleElement.textContent = 'Talepler > Talep Detay';
            }
        }

        function enableViewMode(status, statusText) {
            // Show status badge
            const badge = document.getElementById('statusBadge');
            badge.style.display = 'inline-block';
            badge.className = 'status-badge ' + status;
            badge.textContent = statusText;
            badge.style.padding = '8px 16px';
            badge.style.marginRight = '10px';

            // Show view mode notice
            const notice = document.getElementById('viewModeNotice');
            notice.style.display = 'block';

            let reasonText = '';
            if (status === 'onaylandi') reasonText = 'Talep onaylanmƒ±≈ü durumda.';
            else if (status === 'teslim') reasonText = 'Talep teslim edilmi≈ü durumda.';
            else if (status === 'reddedildi') reasonText = 'Talep reddedilmi≈ü durumda.';
            else if (status === 'beklemede') reasonText = 'Talep onay s√ºrecinde.';
            else if (status === 'iptal') reasonText = 'Talep iptal edilmi≈ü.';
            document.getElementById('viewModeReason').textContent = reasonText;

            // Disable all form inputs
            document.querySelectorAll('input, select, textarea').forEach(el => {
                el.disabled = true;
                if (el.type !== 'checkbox') {
                    el.style.backgroundColor = '#f5f5f5';
                }
            });

            // Disable checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(el => {
                el.disabled = true;
            });

            // Hide edit action buttons, show view buttons
            document.getElementById('actionButtons').style.display = 'none';
            document.getElementById('viewActionButtons').style.display = 'block';

            // Hide add/delete/change buttons
            document.getElementById('addMaterialBtn').style.display = 'none';
            document.querySelectorAll('#materialsTable .btn-danger, #materialsTable .btn-outline').forEach(btn => {
                btn.style.display = 'none';
            });
        }

        // Initialize page based on mode
        if (mode === 'create') {
            // New request creation mode
            updatePageTitle('create', '');
        } else if (requestId && requestData[requestId]) {
            const data = requestData[requestId];

            // Update page title
            updatePageTitle(mode, requestId);

            // Update request number display
            document.getElementById('requestNumber').value = requestId;

            // Load request data (in real app, this would be an API call)
            // For now, we're just using the hardcoded data

            if (mode === 'view') {
                // View mode - read-only
                enableViewMode(data.status, data.statusText);
            } else if (mode === 'edit') {
                // Edit mode
                if (!data.editable) {
                    // If not editable, switch to view mode
                    alert('Bu talep d√ºzenlenemez. G√∂r√ºnt√ºleme moduna ge√ßiliyor.');
                    enableViewMode(data.status, data.statusText);
                    updatePageTitle('view', requestId);
                } else {
                    // Show status badge in edit mode
                    const badge = document.getElementById('statusBadge');
                    badge.style.display = 'inline-block';
                    badge.className = 'status-badge ' + data.status;
                    badge.textContent = data.statusText;
                    badge.style.padding = '8px 16px';
                    badge.style.marginRight = '10px';
                }
            }
        }

        // Week number change updates first day
        document.getElementById('weekNumber').addEventListener('change', function() {
            const weekMapping = {
                '50': '2025-12-09',
                '51': '2025-12-16',
                '52': '2025-12-23',
                '1': '2025-12-30'
            };
            document.getElementById('weekFirstDay').value = weekMapping[this.value] || '';
        });

        // Cost center change updates title
        document.getElementById('costCenterCode').addEventListener('change', function() {
            const titleMapping = {
                'CC-001': '√úretim B√∂l√ºm√º',
                'CC-002': 'Bakƒ±m B√∂l√ºm√º',
                'CC-003': 'Kalite B√∂l√ºm√º'
            };
            document.getElementById('costCenterTitle').value = titleMapping[this.value] || '';
        });

        // ======================================
        // Material Data and Modal Handling
        // ======================================
        const materialData = [
            { id: '01.00001-0001', description: 'Elektrik Motoru 5.5kW', unit: 'AD', stock: 12, group: 'ELK' },
            { id: '01.00002-0001', description: 'Rulman 6205-2RS', unit: 'AD', stock: 45, group: 'MEK' },
            { id: '01.00003-0001', description: 'Hidrolik Yaƒü ISO 46', unit: 'LT', stock: 200, group: 'YAG' },
            { id: '01.00004-0001', description: 'Kayƒ±≈ü V-Belt A68', unit: 'AD', stock: 28, group: 'MEK' },
            { id: '01.00005-0001', description: 'Filtre Hava Kompres√∂r', unit: 'AD', stock: 15, group: 'FLT' },
            { id: '01.00006-0001', description: 'Conta Seti Pompa', unit: 'TK', stock: 8, group: 'MEK' },
            { id: '01.00007-0001', description: 'Sigorta 10A', unit: 'AD', stock: 100, group: 'ELK' },
            { id: '01.00008-0001', description: 'Kontakt√∂r 25A', unit: 'AD', stock: 22, group: 'ELK' },
            { id: '01.00009-0001', description: 'Sens√∂r Proximity M18', unit: 'AD', stock: 35, group: 'ELK' },
            { id: '01.00010-0001', description: 'Pn√∂matik Silindir 50x100', unit: 'AD', stock: 6, group: 'PNO' },
            { id: '01.00011-0001', description: 'Valf Solenoid 24V', unit: 'AD', stock: 18, group: 'PNO' },
            { id: '01.00012-0001', description: 'Gres Yaƒüƒ± EP2', unit: 'KG', stock: 50, group: 'YAG' },
            { id: '01.00013-0001', description: 'Mil Ke√ßesi 40x55x7', unit: 'AD', stock: 40, group: 'MEK' },
            { id: '01.00014-0001', description: 'Di≈üli Kutusu Yaƒüƒ±', unit: 'LT', stock: 80, group: 'YAG' },
            { id: '01.00015-0001', description: 'Kablo NYY 3x2.5', unit: 'MT', stock: 500, group: 'ELK' }
        ];

        let selectedMaterial = null;
        const modal = document.getElementById('materialModal');
        const materialListBody = document.getElementById('materialListBody');
        const searchInput = document.getElementById('materialSearch');
        const selectBtn = document.getElementById('modalSelectBtn');

        function renderMaterialList(materials) {
            if (materials.length === 0) {
                materialListBody.innerHTML = '<div class="no-results">Arama kriterlerine uygun malzeme bulunamadƒ±.</div>';
                return;
            }

            materialListBody.innerHTML = materials.map(m => `
                <div class="material-list-item" data-id="${m.id}" data-desc="${m.description}" data-unit="${m.unit}">
                    <span><input type="radio" name="materialSelect" value="${m.id}"></span>
                    <span>${m.id}</span>
                    <span>${m.description}</span>
                    <span>${m.unit}</span>
                    <span>${m.stock}</span>
                    <span>${m.group}</span>
                </div>
            `).join('');

            // Add click handlers
            materialListBody.querySelectorAll('.material-list-item').forEach(item => {
                item.addEventListener('click', function() {
                    // Remove previous selection
                    materialListBody.querySelectorAll('.material-list-item').forEach(i => i.classList.remove('selected'));
                    // Select this item
                    this.classList.add('selected');
                    this.querySelector('input[type="radio"]').checked = true;
                    selectedMaterial = {
                        id: this.dataset.id,
                        description: this.dataset.desc,
                        unit: this.dataset.unit
                    };
                    selectBtn.disabled = false;
                });
            });
        }

        function openModal() {
            selectedMaterial = null;
            selectBtn.disabled = true;
            searchInput.value = '';
            renderMaterialList(materialData);
            modal.classList.add('active');
            searchInput.focus();
        }

        function closeModal() {
            modal.classList.remove('active');
            window.replacingRow = null;
            selectBtn.textContent = 'Se√ß ve Ekle';
        }

        function searchMaterials() {
            const query = searchInput.value.toLowerCase().trim();
            if (!query) {
                renderMaterialList(materialData);
                return;
            }
            const filtered = materialData.filter(m =>
                m.id.toLowerCase().includes(query) ||
                m.description.toLowerCase().includes(query) ||
                m.group.toLowerCase().includes(query)
            );
            renderMaterialList(filtered);
        }

        function addMaterialToTable() {
            if (!selectedMaterial) return;

            const tbody = document.querySelector('#materialsTable tbody');
            const rowCount = tbody.querySelectorAll('tr').length + 1;

            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${rowCount}</td>
                <td>
                    <div class="input-group">
                        <input type="text" class="form-control form-control-sm" value="${selectedMaterial.id}" readonly>
                        <button class="btn btn-sm btn-outline" title="Deƒüi≈ütir">üîÑ</button>
                    </div>
                </td>
                <td>${selectedMaterial.description}</td>
                <td><input type="number" class="form-control form-control-sm" value="1" min="1" style="width: 90px;"></td>
                <td>${selectedMaterial.unit}</td>
                <td><input type="checkbox" class="priority-checkbox"></td>
                <td><button class="btn btn-sm btn-danger">Sil</button></td>
            `;

            tbody.appendChild(newRow);

            // Add delete handler
            newRow.querySelector('.btn-danger').addEventListener('click', function() {
                const row = this.closest('tr');
                const materialNo = row.querySelector('input').value;
                const materialDesc = row.cells[2].textContent;
                if (confirm('Item number silinecek:\n\n' + materialNo + ' - ' + materialDesc + '\n\nDevam etmek istiyor musunuz?')) {
                    row.style.transition = 'opacity 0.3s';
                    row.style.opacity = '0';
                    setTimeout(function() {
                        row.remove();
                        // Renumber rows
                        document.querySelectorAll('#materialsTable tbody tr').forEach((r, idx) => {
                            r.cells[0].textContent = idx + 1;
                        });
                    }, 300);
                }
            });

            // Add change material handler
            newRow.querySelector('.btn-outline').addEventListener('click', function() {
                openModal();
            });

            closeModal();
        }

        // Add material button - opens modal
        document.getElementById('addMaterialBtn').addEventListener('click', openModal);

        // Modal close button
        document.getElementById('modalClose').addEventListener('click', closeModal);

        // Modal cancel button
        document.getElementById('modalCancelBtn').addEventListener('click', closeModal);

        // Modal select button
        document.getElementById('modalSelectBtn').addEventListener('click', addMaterialToTable);

        // Search button
        document.getElementById('searchBtn').addEventListener('click', searchMaterials);

        // Search on enter key
        searchInput.addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                searchMaterials();
            }
        });

        // Close modal on overlay click
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Close modal on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && modal.classList.contains('active')) {
                closeModal();
            }
        });

        // Save button
        document.getElementById('saveBtn').addEventListener('click', function() {
            const requestNo = document.getElementById('requestNumber').value;
            const weekNum = document.getElementById('weekNumber').value;
            const description = document.getElementById('requestDescription').value;

            // Validation
            if (!weekNum) {
                alert('L√ºtfen hafta numarasƒ± se√ßiniz!');
                return;
            }
            if (!description || description.length < 10) {
                alert('Talep a√ßƒ±klamasƒ± en az 10 karakter olmalƒ±dƒ±r!');
                return;
            }

            // Check delivery locations
            const checkedLocations = document.querySelectorAll('input[name="deliveryLocation"]:checked').length;
            const otherLocation = document.getElementById('otherLocation').value;
            if (checkedLocations === 0 && !otherLocation) {
                alert('En az bir teslimat lokasyonu se√ßmelisiniz!');
                return;
            }

            // Check materials table
            const materialRows = document.querySelectorAll('#materialsTable tbody tr').length;
            if (materialRows === 0) {
                alert('En az bir malzeme eklemelisiniz!');
                return;
            }

            let actionText = mode === 'create' ? 'olu≈üturulacak' : 'g√ºncellenecek';
            let confirmText = mode === 'create' ? 'Malzeme Talebi olu≈üturulacak!' : 'Malzeme Talebi g√ºncellenecek!';

            if (confirm(confirmText + '\n\nSRM Request number: ' + requestNo + '\nHafta: ' + weekNum + '\n\nDevam etmek istiyor musunuz?')) {
                alert('Talep ba≈üarƒ±yla kaydedildi!\n\nSRM Request number: ' + requestNo);
                window.location.href = 'material-request-list.html';
            }
        });

        // Cancel button
        document.getElementById('cancelBtn').addEventListener('click', function() {
            if (confirm('ƒ∞ptal etmek istediƒüinizden emin misiniz?\n\nKaydedilmemi≈ü deƒüi≈üiklikler kaybolacak.')) {
                window.location.href = 'material-request-list.html';
            }
        });

        // Delete row buttons
        document.querySelectorAll('#materialsTable tbody .btn-danger').forEach(function(btn) {
            btn.addEventListener('click', function() {
                const row = this.closest('tr');
                const materialNo = row.querySelector('input').value;
                const materialDesc = row.cells[2].textContent;

                if (confirm('Item number silinecek:\n\n' + materialNo + ' - ' + materialDesc + '\n\nDevam etmek istiyor musunuz?')) {
                    row.style.transition = 'opacity 0.3s';
                    row.style.opacity = '0';
                    setTimeout(function() {
                        row.remove();
                        alert('Item number silindi');
                    }, 300);
                }
            });
        });

        // Change material buttons - open modal for replacement
        document.querySelectorAll('#materialsTable tbody .btn-outline').forEach(function(btn) {
            btn.addEventListener('click', function() {
                const row = this.closest('tr');
                // Store reference to current row for replacement
                window.replacingRow = row;
                openModalForReplacement();
            });
        });

        // Open modal for material replacement
        function openModalForReplacement() {
            selectedMaterial = null;
            selectBtn.disabled = true;
            selectBtn.textContent = 'Se√ß ve Deƒüi≈ütir';
            searchInput.value = '';
            renderMaterialList(materialData);
            modal.classList.add('active');
            searchInput.focus();
        }

        // Override select button for replacement mode
        const originalSelectHandler = addMaterialToTable;
        document.getElementById('modalSelectBtn').removeEventListener('click', addMaterialToTable);
        document.getElementById('modalSelectBtn').addEventListener('click', function() {
            if (!selectedMaterial) return;

            if (window.replacingRow) {
                // Replacement mode - update existing row
                const row = window.replacingRow;
                row.querySelector('input[type="text"]').value = selectedMaterial.id;
                row.cells[2].textContent = selectedMaterial.description;
                row.cells[4].textContent = selectedMaterial.unit;
                window.replacingRow = null;
                selectBtn.textContent = 'Se√ß ve Ekle';
                closeModal();
            } else {
                // Add new material
                addMaterialToTable();
            }
        });

    </script>

    <!-- DEVELOPER DOCUMENTATION PANEL -->
    <div id="devDocsPanel" class="dev-docs-panel">
        <button class="dev-docs-toggle" onclick="toggleDevDocs()">üìã Geli≈ütirici Dok√ºmantasyonu</button>
        <div class="dev-docs-content" id="devDocsContent">
            <div class="dev-docs-header">
                <h2>üìã 16 MR - Material Request</h2>
                <button class="dev-docs-close" onclick="toggleDevDocs()">‚úï</button>
            </div>
            <div class="dev-docs-body">
                <div class="dev-docs-tabs">
                    <button class="dev-tab active" onclick="showDevTab('dataStructure')">Veri Yapƒ±larƒ±</button>
                    <button class="dev-tab" onclick="showDevTab('formFields')">Form Alanlarƒ±</button>
                    <button class="dev-tab" onclick="showDevTab('businessRules')">ƒ∞≈ü Kurallarƒ±</button>
                    <button class="dev-tab" onclick="showDevTab('validations')">Validasyonlar</button>
                </div>
                <div id="dataStructure" class="dev-tab-content active">
                    <h3>Material Request Header</h3>
                    <table class="dev-table">
                        <thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>Material request header Id</td><td>int</td><td>12</td><td>Primary key</td></tr>
                            <tr><td>SL user info</td><td>int</td><td>8</td><td>SL kullanƒ±cƒ± ID</td></tr>
                            <tr><td>Created by user info</td><td>int</td><td>8</td><td>Olu≈üturan kullanƒ±cƒ±</td></tr>
                            <tr><td>Created for user info</td><td>int</td><td>8</td><td>Kimin i√ßin olu≈üturuldu</td></tr>
                            <tr><td>Creation date time</td><td>datetime</td><td>-</td><td>Olu≈üturma tarihi</td></tr>
                            <tr><td>Selected week number</td><td>int</td><td>2</td><td>Se√ßilen hafta numarasƒ± (zorunlu)</td></tr>
                            <tr><td>Selected weeks first day</td><td>date</td><td>-</td><td>Haftanƒ±n ilk g√ºn√º</td></tr>
                            <tr><td>Description for the request</td><td>text</td><td>256</td><td>Talep a√ßƒ±klamasƒ±</td></tr>
                            <tr><td>Requesting department</td><td>text</td><td>8</td><td>Talep eden departman</td></tr>
                            <tr><td>Requesting user info</td><td>int</td><td>8</td><td>Talep eden kullanƒ±cƒ±</td></tr>
                            <tr><td>Cost Center Code</td><td>text</td><td>10</td><td>Masraf merkezi kodu</td></tr>
                            <tr><td>Total Euro Value of request</td><td>float</td><td>15</td><td>Toplam Euro deƒüeri</td></tr>
                            <tr><td>Delivery Location 1-5 id</td><td>text</td><td>8</td><td>Teslimat lokasyonlarƒ± (5 adet)</td></tr>
                            <tr><td>Other Location text</td><td>text</td><td>64</td><td>Diƒüer lokasyon a√ßƒ±klamasƒ±</td></tr>
                            <tr><td>Over budget value</td><td>float</td><td>14</td><td>B√ºt√ße a≈üƒ±m miktarƒ±</td></tr>
                            <tr><td>Request total value</td><td>float</td><td>14</td><td>Talep toplam deƒüeri</td></tr>
                            <tr><td>SL approval check</td><td>bool</td><td>-</td><td>SL onayƒ± gerekli mi?</td></tr>
                            <tr><td>SL approval no required check</td><td>bool</td><td>-</td><td>SL onayƒ± gerekmez</td></tr>
                            <tr><td>SL approver user info</td><td>int</td><td>8</td><td>SL onaylayƒ±cƒ± kullanƒ±cƒ±</td></tr>
                            <tr><td>SL approval date time</td><td>datetime</td><td>-</td><td>SL onay tarihi</td></tr>
                            <tr><td>over budget check</td><td>bool</td><td>-</td><td>B√ºt√ße a≈üƒ±mƒ± var mƒ±?</td></tr>
                            <tr><td>Reserved Over Budget flag</td><td>bool</td><td>-</td><td>Rezervasyon b√ºt√ße a≈üƒ±mƒ±</td></tr>
                            <tr><td>Reserved Over Budget Value</td><td>float</td><td>14</td><td>Rezervasyon a≈üƒ±m tutarƒ± (EUR)</td></tr>
                            <tr><td>Consumed Over Budget flag</td><td>bool</td><td>-</td><td>T√ºketim b√ºt√ße a≈üƒ±mƒ±</td></tr>
                            <tr><td>Consumed Over Budget Value</td><td>float</td><td>14</td><td>T√ºketim a≈üƒ±m tutarƒ± (EUR)</td></tr>
                            <tr><td>Budget Id</td><td>int</td><td>8</td><td>Baƒülƒ± b√ºt√ße ID</td></tr>
                            <tr><td>Approval finish date time</td><td>datetime</td><td>-</td><td>Onay tamamlanma tarihi</td></tr>
                        </tbody>
                    </table>
                    <h3>Material Request Item</h3>
                    <table class="dev-table">
                        <thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>Material Request item id</td><td>int</td><td>12</td><td>Primary key</td></tr>
                            <tr><td>Material request header Id</td><td>int</td><td>8</td><td>Header FK</td></tr>
                            <tr><td>Material request item no</td><td>int</td><td>4</td><td>Satƒ±r numarasƒ±</td></tr>
                            <tr><td>Material number</td><td>text</td><td>13</td><td>Malzeme numarasƒ±</td></tr>
                            <tr><td>Requested Quantity</td><td>float</td><td>15</td><td>Talep edilen miktar</td></tr>
                            <tr><td>Priority</td><td>bool</td><td>-</td><td>√ñncelikli mi?</td></tr>
                            <tr><td>Delivered quantity</td><td>float</td><td>15</td><td>Teslim edilen miktar</td></tr>
                            <tr><td>Material delivery finalized</td><td>bool</td><td>-</td><td>Teslimat tamamlandƒ± mƒ±?</td></tr>
                            <tr><td>Item total Euro value</td><td>float</td><td>14</td><td>Satƒ±r Euro deƒüeri</td></tr>
                            <tr><td>Selected to transfer</td><td>bool</td><td>-</td><td>Transfer i√ßin se√ßildi mi?</td></tr>
                            <tr><td>Rollback initiated check</td><td>bool</td><td>-</td><td>Geri alma ba≈ülatƒ±ldƒ± mƒ±?</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="formFields" class="dev-tab-content">
                    <h3>Talep Ba≈ülƒ±k Bilgileri</h3>
                    <table class="dev-table">
                        <thead><tr><th>Alan</th><th>Tip</th><th>A√ßƒ±klama</th></tr></thead>
                        <tbody>
                            <tr><td>Material request Id</td><td>readonly</td><td>Talep numarasƒ± (otomatik)</td></tr>
                            <tr><td>Created by user info</td><td>readonly</td><td>Olu≈üturan kullanƒ±cƒ±</td></tr>
                            <tr><td>Creation date time</td><td>readonly</td><td>Olu≈üturma tarihi</td></tr>
                            <tr><td>Created for user info *</td><td>dropdown</td><td>Talep kimin i√ßin</td></tr>
                            <tr><td>Requesting department *</td><td>dropdown</td><td>Talep eden departman</td></tr>
                            <tr><td>Cost Center Code *</td><td>dropdown</td><td>Masraf merkezi</td></tr>
                            <tr><td>Selected week number *</td><td>dropdown</td><td>Hafta se√ßimi (zorunlu)</td></tr>
                            <tr><td>Selected weeks first day</td><td>readonly</td><td>Haftanƒ±n ilk g√ºn√º</td></tr>
                            <tr><td>Description for the request</td><td>textarea</td><td>Talep a√ßƒ±klamasƒ± (max 256)</td></tr>
                        </tbody>
                    </table>
                    <h3>Teslimat Lokasyonlarƒ±</h3>
                    <table class="dev-table">
                        <thead><tr><th>Alan</th><th>Tip</th><th>A√ßƒ±klama</th></tr></thead>
                        <tbody>
                            <tr><td>Delivery Location 1-5</td><td>checkbox</td><td>√ñnceden tanƒ±mlƒ± teslimat noktalarƒ±</td></tr>
                            <tr><td>Other Location text</td><td>text</td><td>Diƒüer lokasyon a√ßƒ±klamasƒ± (max 64)</td></tr>
                        </tbody>
                    </table>
                    <h3>Malzeme Se√ßimi (Modal)</h3>
                    <table class="dev-table">
                        <thead><tr><th>Alan</th><th>Tip</th><th>A√ßƒ±klama</th></tr></thead>
                        <tbody>
                            <tr><td>Material search</td><td>search</td><td>Malzeme arama (numara/ba≈ülƒ±k)</td></tr>
                            <tr><td>Material number</td><td>readonly</td><td>Se√ßilen malzeme numarasƒ±</td></tr>
                            <tr><td>Material title</td><td>readonly</td><td>Malzeme ba≈ülƒ±ƒüƒ±</td></tr>
                            <tr><td>Unit</td><td>readonly</td><td>√ñl√ß√º birimi</td></tr>
                            <tr><td>Available Stock</td><td>readonly</td><td>Mevcut stok</td></tr>
                            <tr><td>Unit Price (EUR)</td><td>readonly</td><td>Birim fiyat Euro</td></tr>
                        </tbody>
                    </table>
                    <h3>Talep Kalemleri Tablosu</h3>
                    <table class="dev-table">
                        <thead><tr><th>Kolon</th><th>Tip</th><th>A√ßƒ±klama</th></tr></thead>
                        <tbody>
                            <tr><td>Item no</td><td>readonly</td><td>Satƒ±r numarasƒ±</td></tr>
                            <tr><td>Material number</td><td>readonly</td><td>Malzeme numarasƒ±</td></tr>
                            <tr><td>Material title</td><td>readonly</td><td>Malzeme ba≈ülƒ±ƒüƒ±</td></tr>
                            <tr><td>Unit</td><td>readonly</td><td>√ñl√ß√º birimi</td></tr>
                            <tr><td>Requested Quantity *</td><td>number</td><td>Talep edilen miktar</td></tr>
                            <tr><td>Unit Price (EUR)</td><td>readonly</td><td>Birim fiyat Euro</td></tr>
                            <tr><td>Item total Euro value</td><td>readonly</td><td>Satƒ±r toplam deƒüeri</td></tr>
                            <tr><td>Priority</td><td>checkbox</td><td>√ñncelikli mi?</td></tr>
                            <tr><td>Stock Location</td><td>readonly</td><td>Storage/Location/Bin</td></tr>
                        </tbody>
                    </table>
                    <h3>B√ºt√ße Bilgileri (Readonly)</h3>
                    <table class="dev-table">
                        <thead><tr><th>Alan</th><th>A√ßƒ±klama</th></tr></thead>
                        <tbody>
                            <tr><td>Total Euro Value of request</td><td>Toplam talep deƒüeri EUR</td></tr>
                            <tr><td>Open Budget Value</td><td>Mevcut a√ßƒ±k b√ºt√ße</td></tr>
                            <tr><td>Over budget value</td><td>B√ºt√ße a≈üƒ±m miktarƒ±</td></tr>
                            <tr><td>over budget check</td><td>B√ºt√ße a≈üƒ±mƒ± var mƒ± badge</td></tr>
                        </tbody>
                    </table>
                    <h3>Action Buttons</h3>
                    <table class="dev-table">
                        <thead><tr><th>Buton</th><th>A√ßƒ±klama</th></tr></thead>
                        <tbody>
                            <tr><td>Add Material (+)</td><td>Malzeme se√ßim modalƒ±nƒ± a√ß</td></tr>
                            <tr><td>Remove Item</td><td>Se√ßili kalemi sil</td></tr>
                            <tr><td>Save Draft</td><td>Taslak olarak kaydet</td></tr>
                            <tr><td>Submit Request</td><td>Talebi g√∂nder (onay s√ºrecine)</td></tr>
                            <tr><td>Cancel</td><td>ƒ∞ptal et ve listeye d√∂n</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="businessRules" class="dev-tab-content">
                    <h3>ƒ∞≈ü Kurallarƒ± - Malzeme Talebi</h3>
                    <div class="rules-section">
                        <h4>Maliyet G√∂r√ºn√ºrl√ºƒü√º</h4>
                        <ul>
                            <li><strong>Maliyet g√∂r√ºn√ºr olmalƒ±:</strong> Malzeme maliyeti talep edene G√ñSTERƒ∞LMELƒ∞Dƒ∞R</li>
                            <li>T√ºm maliyetler Euro para birimi cinsindendir</li>
                            <li>Her satƒ±r i√ßin kalem toplam Euro deƒüeri g√∂r√ºnt√ºlenir</li>
                            <li>Talebin Toplam Euro Deƒüeri otomatik olarak hesaplanƒ±r</li>
                        </ul>
                        <h4>Stok Tahsisi (FIFO)</h4>
                        <ul>
                            <li><strong>FIFO KATDIR:</strong> ƒ∞lk √ßƒ±karƒ±lan malzeme en eski fiyata sahiptir</li>
                            <li>Stok otomatik olarak tahsis edilir, manuel olarak yeniden tahsis EDƒ∞LEMEZ</li>
                            <li>Malzeme talebe eklendiƒüi anda √ßƒ±kƒ±≈üa kadar rezerve edilir</li>
                            <li>A≈üan miktar gerektiƒüinde diƒüer stok kayƒ±tlarƒ±na atanƒ±r</li>
                            <li>Rezerve malzemeler ve fiyatlar yeni satƒ±rlarla g√∂r√ºnt√ºlenir</li>
                        </ul>
                        <h4>Depolama Tipleri</h4>
                        <ul>
                            <li>Depo, Lokasyon ve Raflar √ú√á farklƒ± depolama tipidir</li>
                        </ul>
                        <h4>Blokeli Malzemeler</h4>
                        <ul>
                            <li>Blokeli malzemeler G√ñR√úLEBƒ∞Lƒ∞R ancak SE√áƒ∞LEMEZ</li>
                            <li>Kullanƒ±cƒ±lar bloklama nedenini ve bloklama yeniden deƒüerlendirme tarihini g√∂rebilir</li>
                        </ul>
                        <h4>Malzeme Maliyet Se√ßimi</h4>
                        <ul>
                            <li>Bir malzeme i√ßin birden fazla maliyet mevcut olabilir (se√ßerken g√∂sterilir)</li>
                            <li>Stok FIFO kurallarƒ±na g√∂re se√ßilir</li>
                        </ul>
                        <h4>Stok Limitleri</h4>
                        <ul>
                            <li>Kullanƒ±cƒ± mevcut stoktan fazlasƒ±nƒ± talep EDEMEZ</li>
                            <li>Stok yoksa kullanƒ±cƒ± g√∂rebilir ancak talep EDEMEZ</li>
                            <li>Malzeme girildiƒüinde stok mevcudiyet bilgisi g√∂r√ºnt√ºlenir</li>
                        </ul>
                        <h4>Otomatik √ñneri</h4>
                        <ul>
                            <li>Malzeme kodu: 3 karakterden sonra otomatik √∂neri</li>
                            <li>Malzeme a√ßƒ±klamasƒ±: 3 karakterden sonra √∂neriler</li>
                        </ul>
                        <h4>Onay Hatƒ±rlatmalarƒ±</h4>
                        <ul>
                            <li>3. ve 6. g√ºn: onaylayƒ±cƒ±ya hatƒ±rlatma e-postasƒ±</li>
                            <li>7. g√ºn: onaylayƒ±cƒ±ya VE onaylayƒ±cƒ±nƒ±n ilk y√∂neticisine hatƒ±rlatma</li>
                        </ul>
                        <h4>Y√∂neticiler ve SL'ler</h4>
                        <ul>
                            <li>Y√∂neticiler ve SL'ler otomatik olarak BT sistemlerinden alƒ±nƒ±r</li>
                        </ul>
                        <h4>Malzeme Limitleri</h4>
                        <ul>
                            <li>Ki≈üi ba≈üƒ±na haftalƒ±k malzeme limiti ayarlanabilir</li>
                            <li>Deƒüer sƒ±fƒ±rsa, malzeme ki≈üi tarafƒ±ndan talep EDƒ∞LEMEZ</li>
                        </ul>
                        <h4>Hafta Numarasƒ±</h4>
                        <ul>
                            <li>Hafta numarasƒ± ZORUNLUDUR</li>
                            <li><strong>Sadece mevcut hafta ve bir sonraki hafta se√ßilebilir</strong></li>
                            <li>Varsayƒ±lan: talebin olu≈üturulduƒüu hafta</li>
                        </ul>
                        <h4>Teslimat Lokasyonu</h4>
                        <ul>
                            <li>Teslimat lokasyonu SE√áƒ∞LMELƒ∞Dƒ∞R</li>
                            <li>4 seviyeli yapƒ±, i≈ü istasyonlarƒ± da se√ßilebilir</li>
                        </ul>
                        <h4>Onay Biti≈ü Tarihi</h4>
                        <ul>
                            <li>Son onay tamamlandƒ±ƒüƒ±nda, alan mevcut tarih/saat ile doldurulur</li>
                        </ul>
                        <h4>Maliyet Merkezleri</h4>
                        <ul>
                            <li>Maliyet Merkezleri Departmanlara atanƒ±r</li>
                            <li>Departmanlara birden fazla maliyet merkezi atanabilir</li>
                            <li>Maliyet merkezi ZORUNLUDUR - onsuz kullanƒ±cƒ± talep yapamaz</li>
                        </ul>
                        <h4>Talep Eden Kullanƒ±cƒ± Bilgisi</h4>
                        <ul>
                            <li>Alanlar talep olu≈üturucu tarafƒ±ndan varsayƒ±lan olarak doldurulur</li>
                        </ul>
                        <h4>Alternatif Onaylayƒ±cƒ±</h4>
                        <ul>
                            <li>Departman y√∂neticileri kendi adlarƒ±na alternatif onaylayƒ±cƒ± atayabilir</li>
                        </ul>
                        <h4>SRM Talep Teslimat Tarihi</h4>
                        <ul>
                            <li>Beklenen teslimat tarihi = kalemlerdeki en eski beklenen teslimat tarihi</li>
                        </ul>
                        <h4>üìã Kopyala-Yapƒ±≈ütƒ±r</h4>
                        <ul>
                            <li>Excel'den kopyalanan veriler yapƒ±≈ütƒ±rƒ±labilir</li>
                            <li>Birden fazla h√ºcre/satƒ±r aynƒ± anda eklenebilir</li>
                            <li>Toplu veri giri≈üi desteklenir</li>
                        </ul>
                        <h4>üîÑ Alternatif Malzeme Se√ßimi</h4>
                        <ul>
                            <li>Alternatif malzeme se√ßilirse ana malzeme YERƒ∞NE eklenir</li>
                            <li><strong>Stok yoksa:</strong> Se√ßilemez (disabled)</li>
                            <li><strong>Bloke ise:</strong> Se√ßilemez, neden g√∂sterilir</li>
                        </ul>
                    </div>
                </div>
                <div id="validations" class="dev-tab-content">
                    <h3>Alan Validasyonlarƒ±</h3>
                    <ul>
                        <li><strong>Selected week number:</strong> Zorunlu, 1-52 arasƒ±</li>
                        <li><strong>Description:</strong> maxlength=256</li>
                        <li><strong>Requesting department:</strong> maxlength=8</li>
                        <li><strong>Cost Center Code:</strong> maxlength=10</li>
                        <li><strong>Material number:</strong> maxlength=13, format: ##.#####-####</li>
                        <li><strong>Requested Quantity:</strong> > 0, ‚â§ mevcut stok</li>
                        <li><strong>Other Location text:</strong> maxlength=64</li>
                    </ul>
                    <h3>Onay Tipleri (Budget Preference)</h3>
                    <table class="dev-table">
                        <thead><tr><th>Kod</th><th>Tip</th><th>A√ßƒ±klama</th></tr></thead>
                        <tbody>
                            <tr><td>1</td><td>SL Approval</td><td>Her talep i√ßin SL onayƒ± gerekli</td></tr>
                            <tr><td>2</td><td>SL over budget approval</td><td>Sadece b√ºt√ße a≈üƒ±mƒ±nda SL onayƒ±</td></tr>
                            <tr><td>3</td><td>Manager approval</td><td>Her talep i√ßin y√∂netici onayƒ±</td></tr>
                            <tr><td>4</td><td>Manager Over budget Approval</td><td>Sadece b√ºt√ße a≈üƒ±mƒ±nda y√∂netici onayƒ±</td></tr>
                            <tr><td>5</td><td>Only TL and above</td><td>Sadece TL ve √ºst√º talep yapabilir</td></tr>
                            <tr><td>6</td><td>Not required</td><td>B√ºt√ße onayƒ± gerekmez</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <style>
        .dev-docs-panel{position:fixed;bottom:0;left:0;right:0;z-index:9999;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
        .dev-docs-toggle{position:absolute;bottom:100%;right:20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;padding:10px 20px;border-radius:8px 8px 0 0;cursor:pointer;font-weight:600;font-size:14px;box-shadow:0 -2px 10px rgba(0,0,0,0.2)}
        .dev-docs-content{display:none;background:#1a1a2e;color:#eee;max-height:60vh;overflow-y:auto;box-shadow:0 -5px 20px rgba(0,0,0,0.3)}
        .dev-docs-content.active{display:block}
        .dev-docs-header{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);position:sticky;top:0}
        .dev-docs-header h2{margin:0;font-size:18px}
        .dev-docs-close{background:rgba(255,255,255,0.2);border:none;color:#fff;width:30px;height:30px;border-radius:50%;cursor:pointer;font-size:16px}
        .dev-docs-body{padding:20px}
        .dev-docs-tabs{display:flex;gap:10px;margin-bottom:20px;border-bottom:1px solid #333;padding-bottom:10px}
        .dev-tab{background:#2d2d44;color:#aaa;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;transition:all 0.3s}
        .dev-tab:hover,.dev-tab.active{background:#667eea;color:#fff}
        .dev-tab-content{display:none}
        .dev-tab-content.active{display:block}
        .dev-table{width:100%;border-collapse:collapse;margin:15px 0;font-size:13px}
        .dev-table th,.dev-table td{padding:10px;text-align:left;border:1px solid #333}
        .dev-table th{background:#2d2d44;color:#667eea;font-weight:600}
        .dev-table tr:nth-child(even){background:#252538}
        .dev-docs-body h3{color:#667eea;margin:20px 0 10px;font-size:16px;border-bottom:1px solid #333;padding-bottom:5px}
        .dev-docs-body h4{color:#9580ff;margin:15px 0 8px;font-size:14px}
        .dev-docs-body ul{margin:0 0 15px 20px;line-height:1.8}
        .rules-section{background:#252538;padding:15px;border-radius:8px}
    </style>
    <script>
        function toggleDevDocs(){document.getElementById('devDocsContent').classList.toggle('active')}
        function showDevTab(tabId){document.querySelectorAll('.dev-tab-content').forEach(c=>c.classList.remove('active'));document.querySelectorAll('.dev-tab').forEach(t=>t.classList.remove('active'));document.getElementById(tabId).classList.add('active');event.target.classList.add('active')}
    </script>
</body>
</html>
