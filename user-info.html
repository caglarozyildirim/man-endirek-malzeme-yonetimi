<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KullanÄ±cÄ± Bilgileri - IMMA</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- NAVBAR - Top Navigation (Maximo Style) -->
    <nav class="modern-navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">
                <div class="navbar-logo">M</div>
                <div class="brand-text">
                    <span class="brand-name">IMMA</span>
                    <span class="brand-subtitle">Endirek Malzeme YÃ¶netimi</span>
                </div>
            </a>
                        <ul class="navbar-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <span class="nav-icon">ğŸ“Š</span>
                        Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="material-list.html" class="nav-link">
                        <span class="nav-icon">ğŸ“¦</span>
                        Ana Veriler
                    </a>
                    <div class="dropdown-menu">
                        <a href="material-list.html" class="dropdown-item">Malzeme Listesi</a>
                        <a href="supplier-list.html" class="dropdown-item">TedarikÃ§i Listesi</a>
                        <a href="storage-type-list.html" class="dropdown-item">Depo Tipi Listesi</a>
                        <a href="number-series.html" class="dropdown-item">Numara Serileri</a>
                        <a href="material-group.html" class="dropdown-item">Malzeme GruplarÄ±</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="mrp.html" class="nav-link">
                        <span class="nav-icon">ğŸ“ˆ</span>
                        MRP
                    </a>
                </li>
                <li class="nav-item">
                    <a href="srm-list.html" class="nav-link">
                        <span class="nav-icon">ğŸ›’</span>
                        SatÄ±nalma
                    </a>
                    <div class="dropdown-menu">
                        <a href="srm-list.html" class="dropdown-item">Talep Listesi</a>
                        <a href="goods-receipt.html" class="dropdown-item">Mal Kabul</a>
                        <a href="po-list.html" class="dropdown-item">SatÄ±nalma SipariÅŸleri</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="budget-management.html" class="nav-link">
                        <span class="nav-icon">ğŸ’°</span>
                        BÃ¼tÃ§e
                    </a>
                    <div class="dropdown-menu">
                        <a href="budget-management.html" class="dropdown-item">BÃ¼tÃ§e YÃ¶netimi</a>
                        <a href="budget-preference.html" class="dropdown-item">BÃ¼tÃ§e Tercihleri</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="material-request-list.html" class="nav-link">
                        <span class="nav-icon">ğŸ“‹</span>
                        Talepler
                    </a>
                    <div class="dropdown-menu">
                        <a href="material-request-list.html" class="dropdown-item">Talep Listesi</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="transfer-list.html" class="nav-link">
                        <span class="nav-icon">ğŸ­</span>
                        Stok
                    </a>
                    <div class="dropdown-menu">
                        <a href="direct-issue.html" class="dropdown-item">DoÄŸrudan Ã‡Ä±kÄ±ÅŸ</a>
                        <a href="warehouse-transfer.html" class="dropdown-item">Depo Transferi</a>
                        <a href="transfer-list.html" class="dropdown-item">Transfer Listesi</a>
                        <a href="inventory-counting.html" class="dropdown-item">SayÄ±m Ä°ÅŸlemleri</a>
                        <a href="single-material-counting.html" class="dropdown-item">Tekli Malzeme SayÄ±mÄ±</a>
                        <a href="scrapping.html" class="dropdown-item">Hurda Ä°ÅŸlemleri</a>
                    </div>
                </li>
            </ul>
            <div class="navbar-user">
                <span class="user-name">Ahmet YÄ±lmaz</span>
                <div class="user-avatar">AY</div>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="modern-container">
        <div class="page-header">
            <div>
                <h1 class="page-title">KullanÄ±cÄ± Bilgileri</h1>
                <p class="page-subtitle">HesabÄ±m</p>
            </div>
                <div class="header-actions">
                    <button class="btn btn-danger" onclick="logout()">
                        ğŸšª Ã‡Ä±kÄ±ÅŸ Yap
                    </button>
                </div>
            </header>

            <!-- Developer Notes - Main -->
            <div class="dev-note info">
                <h4>ğŸ“‹ Ekran Bilgisi: KullanÄ±cÄ± Bilgileri (Screen 27 - UI)</h4>
                <p><strong>AmaÃ§:</strong> Oturum aÃ§mÄ±ÅŸ kullanÄ±cÄ±nÄ±n bilgilerini ve yetkilerini gÃ¶rÃ¼ntÃ¼leme.</p>
                <p><strong>Kimlik DoÄŸrulama:</strong> Windows Authentication (IAM) ile SAP entegrasyonu</p>
                <p><strong>KullanÄ±cÄ± Verisi:</strong> SAP HR modÃ¼lÃ¼nden otomatik senkronize edilir</p>
            </div>

            <div class="dev-note warning">
                <h4>âš ï¸ Kimlik DoÄŸrulama AkÄ±ÅŸÄ±</h4>
                <ol>
                    <li>KullanÄ±cÄ± Windows/AD hesabÄ± ile oturum aÃ§ar</li>
                    <li>IAM sistemi kimliÄŸi doÄŸrular</li>
                    <li>SAP_User tablosundan kullanÄ±cÄ± bilgileri Ã§ekilir</li>
                    <li>USR_UserRole ve USR_RolePermission tablolarÄ±ndan yetkiler alÄ±nÄ±r</li>
                    <li>JWT token oluÅŸturulur ve session baÅŸlar</li>
                </ol>
            </div>

            <!-- Kullanici Profil Karti -->
            <div class="card">
                <div class="card-header">
                    <h3>Profil Bilgileri</h3>
                    <button class="btn btn-primary" onclick="switchToCommonUser()">
                        Ortak Kullaniciya Gec
                    </button>
                </div>
                <div class="card-body">
                    <div class="user-profile">
                        <div class="profile-avatar">
                            <div class="avatar-placeholder">AY</div>
                        </div>
                        <div class="profile-details">
                            <div class="info-grid">
                                <div class="info-item">
                                    <label>Ad:</label>
                                    <span><strong>Ahmet</strong></span>
                                </div>
                                <div class="info-item">
                                    <label>Soyad:</label>
                                    <span><strong>Yilmaz</strong></span>
                                </div>
                                <div class="info-item">
                                    <label>Sistem Kullanici ID:</label>
                                    <span>USR-00458</span>
                                </div>
                                <div class="info-item">
                                    <label>Windows Kullanici ID:</label>
                                    <span>ayilmaz</span>
                                </div>
                                <div class="info-item">
                                    <label>Sirket Sicil No:</label>
                                    <span>10045678</span>
                                </div>
                                <div class="info-item">
                                    <label>Son Giris:</label>
                                    <span>12.12.2025 08:45</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Kullanici Departman Atamalari -->
            <div class="card">
                <div class="card-header">
                    <h3>Departman Atamalari</h3>
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Departman Kodu</th>
                                <th>Departman Adi</th>
                                <th>Departmandaki Rol</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>BAKIM</td>
                                <td>Bakim Bolumu</td>
                                <td><span class="status-badge status-active">Bolum Lideri</span></td>
                            </tr>
                            <tr>
                                <td>URETIM</td>
                                <td>Uretim Bolumu</td>
                                <td><span class="status-badge status-preparing">Uye</span></td>
                            </tr>
                            <tr>
                                <td>KALITE</td>
                                <td>Kalite Kontrol</td>
                                <td><span class="status-badge status-pending">Gozlemci</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Yetkilendirme Rolleri -->
            <div class="card">
                <div class="card-header">
                    <h3>Yetkilendirme Rolleri</h3>
                </div>
                <div class="card-body">
                    <div class="dev-note">
                        <h4>Rol Tabanli Yetki Sistemi (RBAC)</h4>
                        <p>Kullaniciya roller atanir, roller ise yetkilere sahiptir.</p>
                        <ul>
                            <li><strong>Tablo:</strong> USR_User - USR_UserRole - USR_Role - USR_RolePermission - USR_Permission</li>
                            <li>Bir kullanici birden fazla role sahip olabilir</li>
                            <li>Yetkiler OR mantigi ile birlestirilir</li>
                        </ul>
                    </div>

                    <h4>Dogrudan Sahip Olunan Roller:</h4>
                    <div class="role-badges">
                        <span class="status-badge status-active">Malzeme Anahtar Kullanici</span>
                        <span class="status-badge status-active">SRM Talep Olusturucu</span>
                        <span class="status-badge status-preparing">Butce Goruntuleyici</span>
                    </div>

                    <h4 style="margin-top: 20px;">Vekalet ile Kazanilan Roller:</h4>
                    <div class="role-badges">
                        <span class="status-badge status-pending">Departman Onaylayici (Vekil)</span>
                    </div>

                    <h4 style="margin-top: 20px;">Yetkiler:</h4>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>ModÃ¼l</th>
                                <th>GÃ¶rÃ¼ntÃ¼le</th>
                                <th>OluÅŸtur</th>
                                <th>DÃ¼zenle</th>
                                <th>Sil</th>
                                <th>Onayla</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Malzeme Verileri</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                            </tr>
                            <tr>
                                <td>Malzeme Talebi</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                            </tr>
                            <tr>
                                <td>SRM Talebi</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                            </tr>
                            <tr>
                                <td>Mal Kabul</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                            </tr>
                            <tr>
                                <td>BÃ¼tÃ§e YÃ¶netimi</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                            </tr>
                            <tr>
                                <td>Stok Ä°ÅŸlemleri</td>
                                <td class="text-success">âœ…</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                                <td class="text-danger">âŒ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Vekalet Bilgileri -->
            <div class="card">
                <div class="card-header">
                    <h3>Vekalet Bilgileri</h3>
                </div>
                <div class="card-body">
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Su An Vekalet Edilen Kisi:</label>
                            <span><strong>Mehmet Demir</strong> - Bakim Muduru</span>
                        </div>
                        <div class="info-item">
                            <label>Vekalet Donemi:</label>
                            <span>01.12.2025 - 31.12.2025</span>
                        </div>
                    </div>
                    <button class="btn btn-secondary" style="margin-top: 16px;" onclick="showOnBehalfHistory()">
                        Vekalet Gecmisini Goruntule
                    </button>
                </div>
            </div>

            <!-- Session Info -->
            <div class="card">
                <div class="card-header">
                    <h3>Oturum Bilgileri</h3>
                </div>
                <div class="card-body">
                    <div class="info-grid">
                        <div class="info-item">
                            <label>GiriÅŸ ZamanÄ±:</label>
                            <span>11.12.2025 08:30:15</span>
                        </div>
                        <div class="info-item">
                            <label>Son Aktivite:</label>
                            <span>11.12.2025 14:45:22</span>
                        </div>
                        <div class="info-item">
                            <label>IP Adresi:</label>
                            <span>10.20.30.45</span>
                        </div>
                        <div class="info-item">
                            <label>TarayÄ±cÄ±:</label>
                            <span>Chrome 120.0</span>
                        </div>
                        <div class="info-item">
                            <label>Oturum SÃ¼resi:</label>
                            <span>6 saat 15 dakika</span>
                        </div>
                        <div class="info-item">
                            <label>Token GeÃ§erliliÄŸi:</label>
                            <span>1 saat 45 dakika</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Activity Log -->
            <div class="card">
                <div class="card-header">
                    <h3>Son Aktiviteler</h3>
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Tarih/Saat</th>
                                <th>Ä°ÅŸlem</th>
                                <th>Detay</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>11.12.2025 14:30</td>
                                <td>Malzeme Talebi OluÅŸturuldu</td>
                                <td>MR-2025-001234</td>
                            </tr>
                            <tr>
                                <td>11.12.2025 11:15</td>
                                <td>SRM Talebi OluÅŸturuldu</td>
                                <td>SRM-2025-000456</td>
                            </tr>
                            <tr>
                                <td>11.12.2025 09:45</td>
                                <td>Malzeme GÃ¶rÃ¼ntÃ¼lendi</td>
                                <td>01.00001-0001</td>
                            </tr>
                            <tr>
                                <td>11.12.2025 08:30</td>
                                <td>Oturum AÃ§Ä±ldÄ±</td>
                                <td>Windows Authentication</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Database Schema -->
            <div class="dev-note success">
                <h4>âœ… KullanÄ±cÄ± VeritabanÄ± YapÄ±sÄ±</h4>
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th>Tablo</th>
                            <th>AÃ§Ä±klama</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>SAP_User</strong></td>
                            <td>SAP'den senkronize edilen kullanÄ±cÄ± bilgileri</td>
                        </tr>
                        <tr>
                            <td><strong>USR_User</strong></td>
                            <td>IMMA kullanÄ±cÄ± kaydÄ± (SAP_UserID ile iliÅŸkili)</td>
                        </tr>
                        <tr>
                            <td><strong>USR_Role</strong></td>
                            <td>Rol tanÄ±mlarÄ±</td>
                        </tr>
                        <tr>
                            <td><strong>USR_UserRole</strong></td>
                            <td>KullanÄ±cÄ±-Rol iliÅŸkisi</td>
                        </tr>
                        <tr>
                            <td><strong>USR_Permission</strong></td>
                            <td>Yetki tanÄ±mlarÄ±</td>
                        </tr>
                        <tr>
                            <td><strong>USR_RolePermission</strong></td>
                            <td>Rol-Yetki iliÅŸkisi</td>
                        </tr>
                        <tr>
                            <td><strong>USR_Session</strong></td>
                            <td>Aktif oturum bilgileri</td>
                        </tr>
                        <tr>
                            <td><strong>AUD_UserActivity</strong></td>
                            <td>KullanÄ±cÄ± aktivite loglarÄ±</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="dev-note">
                <h4>ğŸ“Š Yetki Kontrol API'si</h4>
                <p>Her API Ã§aÄŸrÄ±sÄ±nda yetki kontrolÃ¼ yapÄ±lÄ±r:</p>
                <code>GET /api/auth/check-permission?module=MaterialRequest&action=CREATE</code>
                <p>Middleware katmanÄ±nda JWT token decode edilir ve yetkiler kontrol edilir.</p>
            </div>
        </main>
    </div>

    <style>
        .user-profile {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }
        .profile-avatar {
            flex-shrink: 0;
        }
        .avatar-placeholder {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-light));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
        }
        .profile-details {
            flex: 1;
        }
        .role-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
    </style>

    <script>
        function logout() {
            if (confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinizden emin misiniz?')) {
                alert('Oturum sonlandÄ±rÄ±ldÄ±. GiriÅŸ sayfasÄ±na yÃ¶nlendiriliyorsunuz...');
            }
        }

        function switchToCommonUser() {
            if (confirm('Common User moduna geÃ§mek istediÄŸinizden emin misiniz?\n\nBu modda departman bazlÄ± yetkileriniz kÄ±sÄ±tlanacaktÄ±r.')) {
                alert('Common User moduna geÃ§ildi.\n\nTÃ¼m departman bazlÄ± yetkiler devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±.');
            }
        }

        function showOnBehalfHistory() {
            alert('On Behalf History\n\n' +
                '1. 01.09.2025 - 30.09.2025: Mehmet Demir (FID) - Aktif\n' +
                '2. 01.06.2025 - 30.06.2025: Ali Yilmaz (FIPC) - Tamamlandi\n' +
                '3. 15.03.2025 - 31.03.2025: Fatma Kaya (FIDA) - Tamamlandi');
        }
    </script>
</body>
</html>
